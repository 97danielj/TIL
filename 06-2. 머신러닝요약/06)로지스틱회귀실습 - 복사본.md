[toc]

# 06) 로지스틱 회귀 실습

로지스틱 회귀를 케라스를 통해 구현해봅시다.

## **1. 케라스로 구현하는 로지스틱 회귀**

독립 변수 데이터를 $x$, 숫자 10 이상인 경우에는 1, 미만인 경우에는 0을 부여한 레이블 데이터를 $y$라고 해봅시다.

이번 데이터는 앞서 배운 단순 선형 회귀때와 마찬가지로 1개의 실수 $x$로부터 1개의 실수인 $y$를 예측하는 맵핑 관계를 가지므로 Dense의 output_dim, input_dim 인자값으로 각각 1을 기재합니다. 시그모이드 함수를 사용할 것이므로 **activation의 인자값으로는 sigmoid를 기재해줍니다.** (단순 선형 회귀에서는 linear)

옵티마이저로는 가장 기본적인 경사 하강법인 `sgd`를 사용하였습니다. 시그모이드 함수를 사용한 이진 분류 문제에 손실 함수로 크로스 엔트로피 함수를 사용할 경우 binary_crossentropy를 기재해주면 됩니다. 에포크는 200으로 합니다.

```python
import numpy as np
import matplotlib.pyplot as plt
from tensorflow.keras.models import Dense
from tensorflow.keras.layers import optimizer

x = np.array([-50, -40, -30, -20, -10, -5, 0, 5, 10, 20, 30, 40, 50])
y = np.array([0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1]) # 숫자 10부터 1

model = Sequential()
model.add(Dense(1,input_dim=1,activation='sigmoid'))
sgd = optimizers.SGD(lr=0.01)
model.compile(optimizer=sgd,loss='binary_crossentropy', metrics=['binary_accuracy'])
model.fit(x,y,epochs=200)
```

총 200에 걸쳐 전체 데이터에 대한 오차를 최소화 하는 $w$와 $b$를 찾아내는 작업을 합니다.  약 190회 부터 정확도가 100%가 나오기 시작했습니다. 실제값과 오차를 최소화하도록 값이 변경된 $w$와 $b$의 값을 가진 모델을 이용하여 그래프를 그려보겠습니다.

![img](data:image/png;base64,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)

$x$의 값이 5와 10사이의 어떤 값일때 $y$값이 0.5가 넘기 시작하는 것처럼 보입니다. 정확도가 100%가 나왔었기 때문에 적어도 x의 값이 5일때는 y값이 0.5보다 작고, x의 값이 10일 때는 y값이 0.5를 넘을 것입니다. 이제 x의 값이 5보다 작은 값일 때와 x의 값이 10보다 클 때에 대해서 y값을 출력해봅시다.

```python
print(model.predict([1, 2, 3, 4, 4.5]))
print(model.predict([11, 21, 31, 41, 500]))
```

```python
[[0.5015878 ]
 [0.55707926]
 [0.6111817 ]
 [0.6626771 ]
 [0.6871288 ]]
[[0.90343654]
 [0.9886335 ]
 [0.9987648 ]
 [0.99986696]
 [1.        ]]
```





